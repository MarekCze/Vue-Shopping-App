"use strict";window.RetentionRocket=window.RetentionRocket||{},RetentionRocket.Helpers={toCamelCase:function(e){return e.replace(/^([A-Z])|[\s-_](\w)/g,function(e,t,n){return n?n.toUpperCase():t.toLowerCase()})},Cookies:{set:function(e,t,n,o){var i="",r="";if(n){var c=new Date;c.setTime(c.getTime()+60*n*1e3),i="; expires="+c.toGMTString()}o&&(r="; domain="+o),document.cookie=e+"="+escape(t)+i+r+"; path=/"},get:function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return unescape(i.substring(t.length,i.length))}return null}}},RetentionRocket.Location={LOCATION_URL:"https://api-prod.retentionrock.com/utility/location",COOKIE_NAME:"retention_rocket_location",data:null,locate:function(){return this._hasLocation()?this._resolvedPromise():this._isSaved()?(this._parse(JSON.parse(this._getLocationCookie())),this._resolvedPromise()):this._fetchLocation()},inEu:function(){return this.locate().then(function(){return this.eu}.bind(this))},outsideEu:function(){return this.locate().then(function(){return!this.eu}.bind(this))},_parse:function(e){for(var t in this.data={},e)if(e.hasOwnProperty(t)){var n=RetentionRocket.Helpers.toCamelCase(t);this.data[n]=e[t],this[n]=this.data[n]}},_save:function(){var e=new Date,t=[];e.setMonth(e.getMonth()+1),t.push(this.COOKIE_NAME+"="+JSON.stringify(this.data)),t.push("expires="+e),t.push("path=/"),document.cookie=t.join(";")},_resolvedPromise:function(){return new Promise(function(e){e(this.data)}.bind(this))},_fetchLocation:function(){return fetch(this.LOCATION_URL).then(function(e){return e.json()}).then(function(e){return this._parse(e),this._save(),this.data}.bind(this))["catch"](function(e){console.error("Could not locate browser: "+e)})},_hasLocation:function(){return null!==this.data},_getLocationCookie:function(){var e=document.cookie.split(";").find(function(e){return e.trim().split("=")[0]==this.COOKIE_NAME}.bind(this));return e?e.split("=")[1]:null},_isSaved:function(){return!!this._getLocationCookie()}},RetentionRocket.Info={getCustomerId:function(){var e=null;return"undefined"!=typeof meta&&meta.page&&meta.page.customerId!=undefined?meta.page.customerId:("undefined"!=typeof ShopifyAnalytics&&"undefined"!=typeof ShopifyAnalytics.meta.page.customerId&&(e=ShopifyAnalytics.meta.page.customerId),"undefined"!=typeof Shopify&&Shopify.checkout&&Shopify.checkout.customer_id&&(e=Shopify.checkout.customer_id),e)},getProductId:function(){var e=null;return"undefined"!=typeof meta&&meta.product&&meta.product.id!=undefined?meta.product.id:e},getPageType:function(){return"undefined"!=typeof meta&&meta.page&&meta.page.pageType!=undefined?meta.page.pageType:window.location.href.endsWith("/cart")?"cart":window.location.href.endsWith("/thank_you")?"order_confirmation":null},getResourceType:function(){return"undefined"!=typeof meta&&meta.page&&meta.page.resourceType!=undefined?meta.page.resourceType:null},getResourceId:function(){return"undefined"!=typeof meta&&meta.page&&meta.page.resourceId!=undefined?meta.page.resourceId:null},getCheckoutToken:function(){var e=null;return"undefined"!=typeof Shopify&&Shopify.checkout&&"undefined"!=typeof Shopify.Checkout&&Shopify.Checkout.token&&(e=Shopify.Checkout.token),e}},function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ahoy=t()}(this,function(){function e(e){return e===undefined}function t(e){return e===Object(e)}function n(e){return Array.isArray(e)}function o(e){return null!=e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.slice}function i(e){return o(e)&&"number"==typeof e.lastModified&&"string"==typeof e.name}function r(e){return e instanceof Date}function c(o,u,a){return u=u||new FormData,e(o)?u:(n(o)?o.forEach(function(e){c(e,u,a+"[]")}):!t(o)||i(o)||r(o)?u.append(a,o):Object.keys(o).forEach(function(e){var t=o[e];if(n(t))for(;e.length>2&&e.lastIndexOf("[]")===e.length-2;)e=e.substring(0,e.length-2);c(t,u,a?a+"["+e+"]":e)}),u)}function u(){return j.urlPrefix+j.visitsUrl}function a(){return j.urlPrefix+j.eventsUrl}function s(){return(j.useBeacon||j.trackNow)&&K&&"undefined"!=typeof window.navigator.sendBeacon}function f(e,t,n){RetentionRocket.Helpers.Cookies.set(e,t,n,j.cookieDomain||j.domain)}function d(e){return RetentionRocket.Helpers.Cookies.get(e)}function p(e){RetentionRocket.Helpers.Cookies.set(e,"",-1)}function h(e){d("ahoy_debug")&&window.console.log(e)}function l(){for(var e;e=B.shift();)e();$=!0}function y(e){$?e():B.push(e)}function g(e,t){var n=e.matches||e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return n?n.apply(e,[t]):(h("Unable to match"),!1)}function k(e,t,n){document.addEventListener(e,function(e){g(e.target,t)&&n(e)})}function _(e){"interactive"===document.readyState||"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function v(){K&&f("ahoy_events",JSON.stringify(W),1)}function w(){var e=document.querySelector("meta[name=csrf-token]");return e&&e.content}function x(){var e=document.querySelector("meta[name=csrf-param]");return e&&e.content}function R(e){var t=w();t&&e.setRequestHeader("X-CSRF-Token",t)}function S(e,t,n){if(K)if(D)D.ajax({type:"POST",url:e,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:R,success:n});else{var o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-Type","application/json"),o.onload=function(){200===o.status&&n()},R(o),o.send(JSON.stringify(t))}}function C(e){var t={events:[e],visit_token:e.visit_token,visitor_token:e.visitor_token,shopify_customer_id:j.shopify_customer_id,product_id:j.product_id,page_type:j.page_type,resource_type:j.resource_type,resource_id:j.resource_id,checkout_token:j.checkout_token};return delete e.visit_token,delete e.visitor_token,t}function I(e){y(function(){S(a(),C(e),function(){for(var t=0;t<W.length;t++)if(W[t].id==e.id){W.splice(t,1);break}v()})})}function b(e){y(function(){var t=C(e),n=x(),o=w();n&&o&&(t[n]=o),t.events_json=JSON.stringify(t.events),delete t.events;var i=M(t);"object"==typeof i.fd&&(i=i.fd),window.navigator.sendBeacon(a(),i)})}function O(){return j.page||window.location.pathname}function T(e){return e&&e.length>0?e:null}function L(e){for(var t in e)e.hasOwnProperty(t)&&null===e[t]&&delete e[t];return e}function N(e){var t=e.target;return L({tag:t.tagName.toLowerCase(),id:T(t.id),"class":T(t.className),page:O(),section:A(t)})}function A(e){for(;e&&e!==document;e=e.parentNode)if(e.hasAttribute("data-section"))return e.getAttribute("data-section");return null}function P(){if($=!1,E=V.getVisitId(),H=V.getVisitorId(),J=d("ahoy_track"),E&&H&&!J)h("Active visit"),l();else if(E||f("ahoy_visit",E=m(),U),d("ahoy_visit")){h("Visit started"),H||f("ahoy_visitor",H=m(),q);var e={visit_token:E,visitor_token:H,platform:j.platform,landing_page:window.location.href,screen_width:window.screen.width,screen_height:window.screen.height,js:!0,shop:j.shop,shop_id:j.shop_id,shopify_customer_id:j.shopify_customer_id,product_id:j.product_id,page_type:j.page_type,resource_type:j.resource_type,resource_id:j.resource_id,checkout_token:j.checkout_token};document.referrer.length>0&&(e.referrer=document.referrer),h(e),S(u(),e,function(){p("ahoy_track"),l()})}else h("Cookies disabled"),l()}var M=c,j={urlPrefix:"https://retention-rocket-webhooks-prod.herokuapp.com",visitsUrl:"/ahoy/visits",eventsUrl:"/ahoy/events",cookieDomain:null,page:null,platform:"Web",useBeacon:!0,startOnReady:!1,shop:"unknown",shop_id:null,shopify_customer_id:null,product_id:null,page_type:null,resource_type:null,resource_id:null,checkout_token:null},V=window.ahoy||window.Ahoy||{};V.configure=function(e){for(var t in e)e.hasOwnProperty(t)&&(j[t]=e[t])},V.configure(V);var E,H,J,D=window.jQuery||window.Zepto||window.$,U=240,q=1051200,$=!1,B=[],K="undefined"!=typeof JSON&&"undefined"!=typeof JSON.stringify,W=[];V.getVisitId=V.getVisitToken=function(){return d("ahoy_visit")},V.getVisitorId=V.getVisitorToken=function(){return d("ahoy_visitor")},V.reset=function(){return p("ahoy_visit"),p("ahoy_visitor"),p("ahoy_events"),p("ahoy_track"),!0},V.debug=function(e){return!1===e?p("ahoy_debug"):f("ahoy_debug","t",525600),!0},V.track=function(e,t){var n={name:e,properties:t||{},time:(new Date).getTime()/1e3,id:m(),js:!0};return y(function(){V.getVisitId()||P(),y(function(){h(n),n.visit_token=V.getVisitId(),n.visitor_token=V.getVisitorId(),s()?b(n):(W.push(n),v(),setTimeout(function(){I(n)},1e3))})}),!0},V.trackView=function(e){var t={url:window.location.href,title:document.title,page:O()};if(e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);V.track("$view",t)},V.trackClicks=function(){k("click","a, button, input[type=submit]",function(e){var t=e.target,n=N(e);n.text="input"==n.tag?t.value:(t.textContent||t.innerText||t.innerHTML).replace(/[\s\r\n]+/g," ").trim(),n.href=t.href,V.track("$click",n)})},V.trackSubmits=function(){k("submit","form",function(e){var t=N(e);V.track("$submit",t)})},V.trackChanges=function(){k("change","input, textarea, select",function(e){var t=N(e);V.track("$change",t)})},V.trackAll=function(){V.trackView(),V.trackClicks(),V.trackSubmits(),V.trackChanges()};try{W=JSON.parse(d("ahoy_events")||"[]")}catch(F){}for(var z=0;z<W.length;z++)I(W[z]);return V.start=function(){P(),V.start=function(){}},_(function(){j.startOnReady&&V.start()}),V}),ahoy.configure({shop:"mr-vincero.myshopify.com",shop_id:"147",shopify_customer_id:RetentionRocket.Info.getCustomerId(),product_id:RetentionRocket.Info.getProductId(),page_type:RetentionRocket.Info.getPageType(),resource_type:RetentionRocket.Info.getResourceType(),resource_id:RetentionRocket.Info.getResourceId(),checkout_token:RetentionRocket.Info.getCheckoutToken()}),ahoy.start(),ahoy.trackView(),"undefined"!=typeof Shopify&&Shopify.checkout&&ahoy.track("order",{order_id:Shopify.checkout.order_id,checkout_token:RetentionRocket.Info.getCheckoutToken(),shopify_customer_id:RetentionRocket.Info.getCustomerId()});